SELECT "broadcasts"."id" AS id, "broadcasts"."title" AS title, COUNT("public"."impressions"."id") AS impressions, AVG("public"."impressions"."response") AS approval, AVG("public"."impressions"."amount") AS average, coalesce(SUM("public"."impressions"."amount"), 0) AS total, coalesce(COUNT("public"."impressions"."id") * (SELECT avg(coalesce("public"."impressions"."amount", 0)) FROM "public"."impressions"), 0) AS expected_amount FROM "broadcasts" LEFT OUTER JOIN "public"."impressions" ON "public"."impressions"."broadcast_id" = "broadcasts"."id" GROUP BY "broadcasts"."id", "broadcasts"."title"
